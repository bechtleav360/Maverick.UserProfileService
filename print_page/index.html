
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.38">
    
    
      
        <title>Print Site - UserProfileService Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="UserProfileService Documentation" class="md-header__button md-logo" aria-label="UserProfileService Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UserProfileService Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bechtleav360/Maverick.UserProfileService" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="UserProfileService Documentation" class="md-nav__button md-logo" aria-label="UserProfileService Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    UserProfileService Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bechtleav360/Maverick.UserProfileService" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Opening remarks
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Introduction/Applied%20Designed%20Patterns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Applied Designed Pattern
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Introduction/Features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Introduction/Licence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Licence
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Architecture/Main%20Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Architecture/Data%20Model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data-Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Requirements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Requirements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_1" >
        
          
          <label class="md-nav__link" for="__nav_4_2_1" id="__nav_4_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Service
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_1">
            <span class="md-nav__icon md-icon"></span>
            Service
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Service/Headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Headers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Service/HealthChecks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Health-Checks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Service/Identity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Identity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Service/SwaggerUI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure SwaggerUI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Service/SyncProxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure SyncProxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Service/TicketStore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Ticketstore
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2_2" id="__nav_4_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SagaWorker
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            SagaWorker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/SagaWorker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SagaWorker Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/SagaWorker/Cleanup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Cleanup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/SagaWorker/Seeding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Seeding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/SagaWorker/Validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Validation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_3" >
        
          
          <label class="md-nav__link" for="__nav_4_2_3" id="__nav_4_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sync
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_3">
            <span class="md-nav__icon md-icon"></span>
            Sync
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Sync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sync Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Sync/LdapConfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure LDAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Sync/Validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Validation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_4" >
        
          
          <label class="md-nav__link" for="__nav_4_2_4" id="__nav_4_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Messaging
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_4">
            <span class="md-nav__icon md-icon"></span>
            Messaging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Messaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Message Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Messaging/AzureServiceBus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AzureServiceBus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Messaging/RabbitMq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RabbitMQ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/BasePath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base Path
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/DatabaseConnection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Configuration/Tracing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tracing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Get%20Started/Docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Installation/Get%20Started/Single%20Instance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Single Instance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Troubleshooting/FirstSteps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    First Steps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Troubleshooting/Health/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Health Endpoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Troubleshooting/Known%20Issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Known Issues
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For Developer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            For Developer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../For%20Developer/API/Service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../For%20Developer/API/Datastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datastructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../For%20Developer/API/TicketStore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tickestore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../For%20Developer/API/RangeConditions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Range Conditions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../For%20Developer/API/VolatileData/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Volatile Data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    <span class="md-ellipsis">
      1. Opening remarks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      I. Introduction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="I. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-applied%20designed%20patterns" class="md-nav__link">
    <span class="md-ellipsis">
      2. Applied Designed Pattern
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-features" class="md-nav__link">
    <span class="md-ellipsis">
      3. Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#introduction-licence" class="md-nav__link">
    <span class="md-ellipsis">
      4. Licence
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      II. Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="II. Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-main%20architecture" class="md-nav__link">
    <span class="md-ellipsis">
      5. Main Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture-data%20model" class="md-nav__link">
    <span class="md-ellipsis">
      6. Data-Models
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-installation" class="md-nav__link">
    <span class="md-ellipsis">
      III. Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III. Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      7. Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      IV. Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IV. Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#troubleshooting-firststeps" class="md-nav__link">
    <span class="md-ellipsis">
      8. First Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-health" class="md-nav__link">
    <span class="md-ellipsis">
      9. Health Endpoints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-known%20issues" class="md-nav__link">
    <span class="md-ellipsis">
      10. Known Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-opening-remarks">Opening remarks</h1>
<p>Welcome to the UserProfileService (abbreviated: <strong>UPS</strong>) documentation. It should provide you with all necessary information to work with this powerful service.</p>
<h2 id="index-what-is-the-userprofileservice">What is the UserProfileService?</h2>
<p>The  UPS is a system designed to manage user data and related entities such as groups, organizations, roles, or functions. 
It consists of three main components:</p>
<ol>
<li>
<p><strong>Service</strong>: The UPS provides a comprehensive API that allows users to modify entities
In this context, "modify" refers to performing CRUD (Create, Read, Update, Delete) operations. This API likely includes endpoints for actions such as creating, updating, deleting, and querying user profiles, groups, organizations, roles, and functions.</p>
</li>
<li>
<p><strong>Saga Worker</strong>: This component is responsible for validating and creating or modifying entities based on the requests received through the API. It handles business logic, data validation, and ensures consistency and integrity of the data. The Saga Worker can be considered the centerpiece of the UPS.</p>
</li>
<li>
<p><strong>Sync Service</strong>: The Sync Service is used to synchronize entities from a third-party system, specifically LDAP (Lightweight Directory Access Protocol) systems in this case. This component facilitates the synchronization of user data and related entities between the UPS and LDAP systems.</p>
</li>
</ol>
<p>The UPS provides a wide range of functionality that will be explained further in this documenation.</p>
<h2 id="index-history-motivation">History / Motivation</h2>
<h3 id="index-bmbf-project">BMBF-Project</h3>
<blockquote>
<p>"Das Bundesministerium für Bildung und Forschung (BMBF) unterstützt die Durchführung von Forschungs- und Innovationsprojekten im Rahmen von themenspezifischen und in themenoffenen Förderprogrammen. Das breite Förderangebot ist auf wichtige Innovations- oder Technologiefelder, aber auch auf unterschiedliche Herausforderungen und Ausgangsbedingungen zugeschnitten. Dabei werden insbesondere innovative kleine und mittlere Unternehmen (KMU) mit spezifischen Förderprogrammen adressiert." (<a href="https://www.bmbf.de/bmbf/de/forschung/zukunftsstrategie/foerderung-in-der-forschung/foerderung-in-der-forschung_node.html">Quelle - Bundesministerium für Bildung und Forschung</a>)</p>
</blockquote>
<p><strong>Translation</strong>: The Federal Ministry of Education and Research (BMBF) supports the implementation of research and innovation projects within topic-specific and open-topic funding programs. The broad range of funding is tailored to important innovation or technology fields, as well as various challenges and starting conditions. In particular, innovative small and medium-sized enterprises (SMEs) are addressed with specific funding programs.</p>
<blockquote>
<p>"Im Zuge der Förderung entstand das Projekt E365 Maverick. Es ist ein durch das BMBF gefördertes Forschungsprojekt, welches im Rahmen einer Kooperation zwischen Bechtle AG und Hochschule Bonn-Rhein-Sieg durchgeführt wird. Es bettet sich in die übergeordnete Initiative „Nationale Bildungsplattform“ des BMBF ein." (<a href="https://www.h-brs.de/de/eagl-digitale-bildungsplattform">Quelle - E365 Maverick Projekt</a>) </p>
</blockquote>
<p><strong>Translation</strong>: As part of the funding, the project E365 Maverick was created. It is a research project funded by the BMBF, which is being conducted in cooperation between <a href="https://www.bechtle.com/">Bechtle AG</a> and the Bonn-Rhein-Sieg University of Applied Sciences. It is embedded within the overarching initiative 'National Education Platform' of the BMBF.</p>
<h3 id="index-splitting-the-ups">Splitting the UPS</h3>
<p>Bechtle provides the UPS, which is intended for user data within the digital education platform. Since GitHub is the largest host of open-source projects, the UPS is made available on this platform. Furthermore, the community within the host is very active, leading to an increase in software quality. Improvements can be noted and discussed by the community, largely ensuring a continuous development of the software with the latest technologies and design patterns.</p>
<p>As the current code base of the UPS is currently in an internal project within Azure DevOps Services, this will continue to be used for the customer-specific part.</p></section>
                        <h1 class='nav-section-title' id='section-introduction'>
                            Introduction <a class='headerlink' href='#section-introduction' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="introduction-applied%20designed%20patterns"><h1 id="introduction-applied%20designed%20patterns-applied-designed-pattern">Applied Designed Pattern</h1>
<p>The UPS has evolved over time into a complex service with multiple components that adhere to current architecture and design patterns.</p>
<p>Firstly, the service relies on <a href="https://www.redhat.com/en/topics/integration/what-is-event-driven-architecture">Event-Driven Design</a> (EDD). In EDD, all events related to UPS are stored centrally. An event is an atomic occurrence that propagates a state change. In our case, an event could involve creating, deleting, or modifying an entity (e.g., a user). Data from this central source can be projected into any database and then retrieved. Projection transforms and stores input data into a database-specific format, significantly reducing access times as data doesn't need conversion during reads.</p>
<p>Next, the service follows the <a href="https://learn.microsoft.com/de-de/azure/architecture/patterns/cqrs">Command-Query-Responsibility-Segregation</a> (CQRS) pattern. This pattern advocates for splitting object models into separate read and write parts within a database. The advantage of this pattern is improved scalability, as write operations can run on different hardware from read operations.</p>
<p>Furthermore, the UPS API supports the <a href="https://learn.microsoft.com/en-us/azure/architecture/patterns/async-request-reply">Asynchronous Request-Reply Pattern</a>(ARRP). This pattern ensures that the API asynchronously handles data modification requests. The status of these modifications can be queried at any time using a dedicated endpoint. Communication in the command part between components is achieved through queuing. Retrieving an entity from the database still occurs via a <a href="https://learn.microsoft.com/en-us/azure/architecture/best-practices/api-design">REST</a> call. Lastly, the UPS utilizes the <a href="https://microservices.io/patterns/data/saga.html">Saga</a> pattern, which simplifies data handling in distributed systems.</p></section><section class="print-page" id="introduction-features"><h1 id="introduction-features-features">Features</h1>
<ul>
<li>Manages user data including their relations</li>
<li>Used entities are hierarchically structured and therefore are stored in a graph.<br />
  like:<ul>
<li><em>Users</em> are stored in groups</li>
<li><em>Organizations</em> can contain other <em>organizations</em></li>
<li><em>Users</em> or <em>groups</em> can be assigned to <em>Functions</em> or <em>Roles</em></li>
<li><em>Functions</em> limit access of their containing <em>role</em> by an additional <em>organization</em></li>
<li>All kind of <em>Assignments</em> can be triggered in the future for an user</li>
<li><em>Volatile Data</em> can be stored in a database and can be used as a container without persisted in the eventstore</li>
</ul>
</li>
<li>Can store the incoming requests in various ways due to its "data projections"</li>
<li>Contains entity models for roles and functions that can be used as source of a <a href="https://en.wikipedia.org/wiki/Role-based_access_control">RBAC</a> system or <a href="https://www.openpolicyagent.org/">OPA</a></li>
</ul></section><section class="print-page" id="introduction-licence"><h1 id="introduction-licence-licence">Licence</h1>
<h2 id="introduction-licence-we-are-using-following-great-third-party-libraries">We are using following great third-party-libraries</h2>
<ul>
<li><a href="https://github.com/AutoMapper/AutoMapper">Automapper</a></li>
<li><a href="https://github.com/MassTransit/MassTransit">MassTransit</a></li>
<li><a href="https://github.com/JasperFx/marten">Marten</a></li>
<li><a href="https://github.com/manuc66/JsonSubTypes">JsonSubtypes</a></li>
<li><a href="https://github.com/JamesNK/Newtonsoft.Json">Newtonsoft.Json</a></li>
<li><a href="https://github.com/domaindrivendev/Swashbuckle.AspNetCore">Swashbuckle</a></li>
<li><a href="https://github.com/khellang/Middleware">Hellang ProblemDetails</a></li>
<li><a href="https://github.com/prometheus-net/prometheus-net">prometheus-net</a></li>
<li><a href="https://github.com/StackExchange/StackExchange.Redis">StackExchange.Redis</a></li>
<li><a href="https://github.com/NLog/NLog">NLog</a></li>
<li><a href="https://github.com/FluentValidation/FluentValidation">FluentValidations</a></li>
</ul>
<h2 id="introduction-licence-for-testing">For testing</h2>
<ul>
<li><a href="https://github.com/xunit/xunit">XUnit</a></li>
<li><a href="https://github.com/fluentassertions/fluentassertions">FluentAssertions</a></li>
<li><a href="https://github.com/AutoFixture/AutoFixture">AutoFixture</a></li>
<li><a href="https://github.com/bchavez/Bogus">Bogus</a></li>
<li><a href="https://github.com/devlooped/moq">Moq</a></li>
</ul></section><h1 class='nav-section-title-end'>Ended: Introduction</h1>
                        <h1 class='nav-section-title' id='section-architecture'>
                            Architecture <a class='headerlink' href='#section-architecture' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="architecture-main%20architecture"><h1 id="architecture-main%20architecture-main-architecture">Main Architecture</h1>
<p>The UserProfileService consists of three main components:</p>
<h3 id="architecture-main%20architecture-userprofileserviceapi">UserProfileService.API</h3>
<p>This is an interface accessible through public networks, specifically a RestAPI with numerous endpoints designed for managing profile entities.</p>
<h3 id="architecture-main%20architecture-userprofileservicesagaworker">UserProfileService.SagaWorker</h3>
<p>This system operates behind the scenes, carrying out commands triggered by the API or Sync processes. It validates and modifies data, and also monitors queues. Due to its nature, it is not meant to be publicly accessible. For security purposes, its endpoints should be restricted behind a firewall or within an internal network.</p>
<h3 id="architecture-main%20architecture-userprofileservicesync">UserProfileService.Sync</h3>
<p>It facilitates the synchronization of data from external sources with the data currently stored. Currently, we have implemented an LDAP connector as one of these external sources.</p>
<h3 id="architecture-main%20architecture-the-architecture">The Architecture</h3>
<p><img alt="&quot;Overview architecture&quot;" src="../Architecture/attachments/png/architecture-overview.png" /></p>
<p>The picture illustrates the comprehensive architecture of the UPS system. Clients can request entities stored in the database. The UPS API then retrieves these entities directly from ArangoDB. The models are stored in the database in the format required by the program, minimizing the need for significant transformations when they are returned.</p>
<p>The Client also has the capability to create an entity, such as a group. When a request is made, the API processes the request and returns a ticket as described below. The API then places a command into a queue that is connected to the SagaWorker. The SagaWorker receives the command and performs the following steps:</p>
<ol>
<li>
<p>Receives the GroupCreate message.</p>
</li>
<li>
<p>Validates the group.</p>
</li>
<li>
<p>Stores the group in the EventStore, a centralized database for storing events. We utilize the PostgreSQL database along with Marten for this purpose.</p>
</li>
<li>
<p>Projects the group into the Arango database.</p>
</li>
</ol>
<p>If the validation of the group or the storing in the EventStore fails, the entire process will be aborted and reversed.</p>
<h3 id="architecture-main%20architecture-ups-sync">UPS-Sync</h3>
<p>It is also noted that UPS-Sync can synchronize entities from an external source, currently limited to LDAP systems. UPS-Sync uses Redis to temporarily store entities that need synchronization. The Sync module then sends messages to the queue, where the SagaWorker listens and creates the necessary entities in the database. Once an entity is created, the Sync module receives a confirmation message.UPS-Sync can thus keep track of the synchronized entities.</p></section><section class="print-page" id="architecture-data%20model"><h1 id="architecture-data%20model-data-models">Data-Models</h1>
<p>The following core entities can currently be created or managed by the service:</p>
<ol>
<li><strong>Users</strong>: User information related to an individual is stored, including their first name, last name, and other personal data.</li>
<li><strong>Groups</strong>: Information about a group is stored (name, members, etc.). Multiple users can be grouped together in a group to, for example, assign specific rights to a number of users.</li>
<li><strong>Organizations</strong>: Organizational data is stored.</li>
<li><strong>Roles</strong>: Information about roles is stored. Roles can be used to assign specific rights to users, allowing access to files/operations.</li>
<li><strong>Functions</strong>: A function consists of a tuple, namely a role and an organizational unit. It determines which rights are assigned to a user or a group. If your organization, for example, is named <code>Department for Airplanes</code> and your role is <code>read</code>, then the name of the function would be <code>Department for Airplanes read</code>. In this case, you would only have <code>read</code> as a permission.</li>
</ol></section><h1 class='nav-section-title-end'>Ended: Architecture</h1>
                        <h1 class='nav-section-title' id='section-installation'>
                            Installation <a class='headerlink' href='#section-installation' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="installation-requirements"><h1 id="installation-requirements-requirements">Requirements</h1>
<h2 id="installation-requirements-third-party-components">Third-party components</h2>
<p>To start the service, you need at least the Service and the SagaWorker components, along with the following third-party components:</p>
<ul>
<li><a href="https://www.arangodb.com/">ArangoDb</a> - open-source graph-and document database where user data will be stored. <a href="#installation-configuration-databaseconnection-arangodb">How to configure Arangodb</a>.</li>
<li>Messaging - multi-protocol messaging and streaming broker - used to send messages between applications. <a href="#installation-configuration-messaging">How to configure Messaging</a>.</li>
<li><a href="https://www.postgresql.org/">PostgreSQL</a> - fast relational database used as volatile store and eventStore. <a href="#installation-configuration-databaseconnection-postgresql">How to configure PostgreSQL</a>.</li>
</ul>
<p>If you want to use UPS-Sync, you will also need this third-party component:</p>
<ul>
<li><a href="https://redis.com/">redis</a> - open source, in-memory data structure store, used as a database, cache, and message broker. <a href="#installation-configuration-redis">How to configure redis</a>.</li>
</ul>
<h2 id="installation-requirements-running-the-ups-from-code">Running the UPS from Code</h2>
<p>To start using the UserProfileService code, you will need the latest .NET 8.0 SDK, which you can download from <a href="https://dotnet.microsoft.com/en-us/download/dotnet/8.0">here</a>, and the Git source system, available for download <a href="https://git-scm.com/downloads">here</a>.</p>
<h2 id="installation-requirements-running-the-ups-with-docker-images">Running the UPS with Docker-Images</h2>
<p>If you want to use the UPS from Docker images, you'll need to install Docker first. For convenience, you will also need Docker Compose, which can be downloaded <a href="https://docs.docker.com/compose/install/">here</a>. You can also get the latest images from <code>ghcr.io/bechtleav360</code>.</p>
<h2 id="installation-requirements-configure-the-ups">Configure the UPS</h2>
<p>To configure the componenets of the Service refere to:</p>
<ul>
<li><a href="#installation-configuration-service">Service-API</a></li>
<li><a href="#installation-configuration-sagaworker">SagaWorker</a></li>
<li><a href="#installation-configuration-sync">Sync</a></li>
</ul></section>
                        <h2 class='nav-section-title' id='section-configuration'>
                            Configuration <a class='headerlink' href='#section-configuration' title='Permanent link'>↵</a>
                        </h2>
                        
                        <h3 class='nav-section-title' id='section-service'>
                            Service <a class='headerlink' href='#section-service' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="installation-configuration-service"><h1 id="installation-configuration-service-service-configuration">Service Configuration</h1>
<p>A valid service configuration can look like this. Please note that you should create a database in ArangoDB and PostgreSQL and grant permissions for the user. This is not done automatically:</p>
<details class="abstract">
<summary>Service example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Delays&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;HealthCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1:00:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;HealthPush&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1:00:00&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;UseSwaggerUI&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>

<span class="nt">&quot;IdentitySettings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ApiName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ApiSecret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Authority&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EnableAnonymousImpersonation&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EnableAuthorization&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EnableCaching&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;RequireHttpsMetadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Logging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;EnableLogFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFileMaxHistory&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFilePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;logs&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;json&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Information&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Marten&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Host=localhost;Port=5432;Username=myUser;Password=myPassword;Database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DatabaseSchema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserProfile&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;StreamNamePrefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ups&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;SubscriptionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserProfileServiceStream&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Messaging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;RabbitMQ&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guest&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5672</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guest&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;VirtualHost&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RabbitMQ&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;ProfileStorage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Endpoints=http://localhost:8529;UserName=myUser;Password=myPassword;database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MinutesBetweenChecks&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Routing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;DiscardResponsePathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;PathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;SyncProxyConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;TicketStore&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Backend&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arangodb&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Tracing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;OtlpEndpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ServiceName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;userprofile-service&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;UseForwardedHeaders&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>The service is configured to allow access to all necessary third-party components through the localhost endpoints.</p></section><section class="print-page" id="installation-configuration-service-headers"><h1 id="installation-configuration-service-headers-configure-headers">Configure Headers</h1>
<p>Here is a sample section on how to configure the headers:</p>
<details class="abstract">
<summary>Headers example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;UseForwardedHeaders&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>UseForwardedHeaders</code> - Specifies whether the application should use forwarded headers or not. When set to false, the application will not use forwarded headers.</p></section><section class="print-page" id="installation-configuration-service-healthchecks"><h1 id="installation-configuration-service-healthchecks-configure-health-checks">Configure Health-Checks</h1>
<p>Here is a sample section on how to configure the health checks:</p>
<details class="abstract">
<summary>Health-Checks example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Delays&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;HealthCheck&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00:05:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;HealthPush&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00:05:00&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>HealthCheck</code>- Specifies the interval at which health checks are performed. The value is represented in hours, minutes, and seconds format (HH:MM:SS). For example, <strong>00:05:00</strong> indicates a health check interval of 5 minutes.</p>
<p><code>HealthPush</code>- Specifies the interval at which health push operations are performed. The value is represented in hours, minutes, and seconds format (HH:MM:SS). For example, <strong>00:05:00</strong> indicates a health push interval of 5 minutes.</p></section><section class="print-page" id="installation-configuration-service-identity"><h1 id="installation-configuration-service-identity-configure-identity">Configure Identity</h1>
<p>Here is a sample section on how to configure the identity settings:</p>
<details class="abstract">
<summary>Identity example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;IdentitySettings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ApiName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MyApi&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ApiSecret&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SuperSecretKey&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Authority&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://identity.example.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EnableAnonymousImpersonation&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EnableAuthorization&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EnableCaching&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;RequireHttpsMetadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>ApiName</code> - The name of the API, typically used to identify the API within your identity provider.</p>
<p><code>ApiSecret</code> - The secret key associated with the API. This key is used for authentication and should be kept confidential.</p>
<p><code>Authority</code> - The URL of the identity provider. This endpoint handles authentication and authorization.</p>
<p><code>EnableAnonymousImpersonation</code> - Determines whether anonymous impersonation is enabled. When enabled, users can impersonate anonymous identities.</p>
<p><code>EnableAuthorization</code>- Specifies whether authorization is enabled. If this option is disabled, the API will not enforce authorization rules.</p>
<p><code>EnableCaching</code> - Indicates whether caching is enabled. When enabled, identity-related data is cached to improve performance.</p>
<p><code>RequireHttpsMetadata</code>- Specifies whether HTTPS is required for retrieving metadata from the identity provider. If this option is disabled, HTTP is also allowed.</p>
<h2 id="installation-configuration-service-identity-notes">Notes</h2>
<ul>
<li>Only the <code>user/me</code> endpoint is secured in the service</li>
<li>Ensure that the ApiSecret is stored securely and not exposed in public repositories.</li>
<li>It is recommended to set RequireHttpsMetadata to true in production environments to ensure secure communication with the identity provider.</li>
<li>The Authority URL must be correctly configured to point to your identity provider to ensure proper authentication and authorization.</li>
</ul></section><section class="print-page" id="installation-configuration-service-swaggerui"><h1 id="installation-configuration-service-swaggerui-configure-swaggerui">Configure SwaggerUI</h1>
<p>Here is a sample section on how to configure the SwaggerUI:</p>
<details class="abstract">
<summary>SwaggerUI example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Features&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;UseSwaggerUI&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>UseSwaggerUI</code> - The UseSwaggerUI setting controls the visibility of the Swagger UI. When enabled, users can access and interact with the API documentation through the Swagger UI. Conversely, when disabled, the Swagger UI is not accessible.</p>
<p><strong>Development Mode Only</strong>: It's important to note that the Swagger UI functionality is only available in <strong>development</strong> mode. This means that it will be active during development and testing phases but is disabled or inaccessible in <strong>production</strong> environments.</p></section><section class="print-page" id="installation-configuration-service-syncproxy"><h1 id="installation-configuration-service-syncproxy-configure-syncproxy">Configure SyncProxy</h1>
<p>Here is a sample section on how to configure the sync proxy:</p>
<details class="abstract">
<summary>SyncProxy example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;SyncProxyConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://example.com/sync-api&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>Endpoint</code> - Specifies the endpoint of the service that will control the Sync API. This endpoint should be set to the URL of the sync that manages the API requests. This allows for centralized control and management of the Sync API via the designated service.</p></section><section class="print-page" id="installation-configuration-service-ticketstore"><h1 id="installation-configuration-service-ticketstore-configure-ticketstore">Configure Ticketstore</h1>
<p>Here is a sample section on how to configure the ticket store:</p>
<details class="abstract">
<summary>Ticketstore example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;TicketStore&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Backend&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arangodb&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>Backend</code> - The Backend setting should be configured to match the database you are using for storing tickets. The possible values are <code>arangodb</code>, <code>sqlServer</code>, <code>postgres</code>, and <code>sqLite</code></p></section><h1 class='nav-section-title-end'>Ended: Service</h1>
                        <h3 class='nav-section-title' id='section-sagaworker'>
                            SagaWorker <a class='headerlink' href='#section-sagaworker' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="installation-configuration-sagaworker"><h1 id="installation-configuration-sagaworker-sagaworker-configuration">SagaWorker Configuration</h1>
<p>A valid saga worker configuration can look like this. Please note that you should create a database in ArangoDB and PostgreSQL and grant permissions for the user. This is not done automatically:</p>
<details class="abstract">
<summary>SagaWorker example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;Cleanup&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;AssignmentProjection&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EventCollector&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Facade&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;FirstLevelProjection&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Interval&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5:00:00:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Service&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Logging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;EnableLogFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFileMaxHistory&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFilePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;logs&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;json&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Information&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Marten&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Host=localhost;Port=5432;Username=myUser;Password=myPassword;Database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DatabaseSchema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserProfile&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;StreamNamePrefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ups&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;SubscriptionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserProfileServiceStream&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Messaging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;RabbitMQ&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guest&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5672</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guest&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;VirtualHost&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RabbitMQ&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;ProfileStorage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ClusterConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;DocumentCollections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;NumberOfShards&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ReplicationFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;WriteConcern&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;EdgeCollections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;NumberOfShards&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ReplicationFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;WriteConcern&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Endpoints=http://localhost:8529;UserName=myUser;Password=myPassword;database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MinutesBetweenChecks&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Routing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;DiscardResponsePathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;PathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Seeding&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Disabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>

<span class="w">  </span><span class="nt">&quot;Tracing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;OtlpEndpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ServiceName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;userprofile-saga-worker&quot;</span>
<span class="w">  </span><span class="p">},</span>


<span class="w">  </span><span class="nt">&quot;Validation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Commands&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;External&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;profile-deleted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>

<span class="w">    </span><span class="nt">&quot;Internal&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Function&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DuplicateAllowed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">},</span>

<span class="w">      </span><span class="nt">&quot;Group&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;Duplicate&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;IgnoreCase&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;Regex&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^[a-zA-Z0-9ÄÖÜäöüß_\\]\\[\\-\\.\\\\ @]+$&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>

<span class="w">      </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DuplicateEmailAllowed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>The saga woker is configured to allow access to all necessary third-party components through the localhost endpoints.</p></section><section class="print-page" id="installation-configuration-sagaworker-cleanup"><h1 id="installation-configuration-sagaworker-cleanup-configure-cleanup-service">Configure Cleanup Service</h1>
<p>The Cleanup configuration section outlines the frequency at which data cleanup operations are performed for various components. Here is a brief example of how to configure the cleanup:</p>
<details class="abstract">
<summary>Cleaup service example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Cleanup&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;AssignmentProjection&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;05:00:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EventCollector&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;05:00:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Facade&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;05:00:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;FirstLevelProjection&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;05:00:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Service&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;05:00:00&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>AssignmentProjection</code>- Specifies the interval at which cleanup operations are performed for the Assignment Projection component.</p>
<p><code>EventCollector</code> - Specifies the interval at which cleanup operations are performed for the Event Collector component.  </p>
<p><code>Facade</code> - Specifies the interval at which cleanup operations are performed for the Facade component. </p>
<p><code>FirstLevelProjection</code> - Specifies the interval at which cleanup operations are performed for the First Level Projection component. </p>
<p><code>Service</code> - Specifies the interval at which cleanup operations are performed for the Service component.</p>
<p><strong>Note</strong>: The value is represented in hours, minutes, and seconds format (HH:MM:SS). In our sample all components will be cleaned every 5 hours.</p></section><section class="print-page" id="installation-configuration-sagaworker-seeding"><h1 id="installation-configuration-sagaworker-seeding-configure-seeding-service">Configure Seeding Service</h1>
<p>The seeding service is responsible for seeding configurations at startup. It can seed the following entities:</p>
<ul>
<li>Functions</li>
<li>Groups</li>
<li>Organizations</li>
<li>Roles</li>
<li>Users </li>
</ul>
<p>A brief section on configuring the seeding service with various entities:</p>
<details class="abstract">
<summary>Seeding example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;SeedingService&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;f2e51ef1-57bc-4c11-931f-079b4303d657&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DisplayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;johndoe@example.com&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;ExternalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f2e51ef1-57bc-4c11-931f-079b4303d657&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SeedingService&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;IsConverted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;FirstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;LastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;UserName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;johnd&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Roles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;fa6ee24b-0fc4-4632-9c0d-5b943d8a8ac8&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;ExternalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fa6ee24b-0fc4-4632-9c0d-5b943d8a8ac8&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SeedingService&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;IsConverted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;DeniedPermissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="s2">&quot;Delete&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;Edit&quot;</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This role provides limited access to certain features.&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;IsSystem&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LimitedAccessRole&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="s2">&quot;Read&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;Write&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;a6ee24b0fc446329c0d5b943d8a8ac8&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DisplayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Marketing Team&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;ExternalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fa6ee24b-0fc4-4632-9c0d-5b943d8a8ac8&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SeedingService&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;IsConverted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Marketing&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Weight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.0</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Organizations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;8a5fd2b1-6e17-4c35-9314-7d13f67f3278&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DisplayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Acme Corporation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;ExternalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;8a5fd2b1-6e17-4c35-9314-7d13f67f3278&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SeedingService&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;IsConverted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;IsSystem&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Acme&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Weight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">2.0</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Functions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;d6d78a90-e5c2-47fb-ba82-71f3cb5f4dc2&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;ExternalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d6d78a90-e5c2-47fb-ba82-71f3cb5f4dc2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SeedingService&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;IsConverted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;OrganizationId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;8a5fd2b1-6e17-4c35-9314-7d13f67f3278&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;RoleId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fa6ee24b-0fc4-4632-9c0d-5b943d8a8ac8&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;Disabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>Users</code> - This describes the users that need to be created. It is represented as a dictionary. Each user is identified by a unique ID which serves as the key, followed by the user's properties that need to be filled out.</p>
<p><code>Roles</code> - This describes the roles that need to be created. It is represented as a dictionary. Each role is identified by a unique ID which serves as the key, followed by the roles's properties that need to be filled out.</p>
<p><code>Groups</code> - This describes the groups that need to be created. It is represented as a dictionary. Each group is identified by a unique ID which serves as the key, followed by the group's properties that need to be filled out.</p>
<p><code>Organizations</code> - This describes the organizations that need to be created. It is represented as a dictionary. Each organization is identified by a unique ID which serves as the key, followed by the organizations's properties that need to be filled out.</p>
<p><code>Functions</code> - This describes the functions that need to be created. It is represented as a dictionary. Each functions is identified by a unique ID which serves as the key, followed by the functions's properties that need to be filled out. </p>
<p><strong>Please Note</strong>: The function consists of an organization and a role ID. The role and organization ID must be present; otherwise, the function won't be created. "Present" means that the role and organization object must already exist or be defined in the seeding service. If it's not present, the function won't be created.</p>
<p><code>Disabled</code> - Indicates whether the seeding service should be disabled. If the seeding service is disabled, none of the creation objects should be configured. The configuration can than look like this:</p>
<details class="abstract">
<summary>Seeding disable example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Seeding&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Disabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="installation-configuration-sagaworker-seeding-notes">Notes</h2>
<p>The seeding service checks every time the saga worker is started whether the seeding objects already exist. If they do not exist, they will be created; otherwise, they will not be created. This is relevant when the seeding service has objects to seed.</p></section><section class="print-page" id="installation-configuration-sagaworker-validation"><h1 id="installation-configuration-sagaworker-validation-configure-sagworker-validation">Configure SagWorker Validation</h1>
<p>Here is a brief section on how the validation can be configured:</p>
<details class="abstract">
<summary>SagaWorker example validation configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Validation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Commands&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;External&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;profile-deleted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Internal&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Function&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DuplicateAllowed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;Group&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;Duplicate&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;IgnoreCase&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;Regex&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^[a-zA-Z0-9ÄÖÜäöüß_\\]\\[\\-\\.\\\\ @]+$&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DuplicateEmailAllowed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>profile-deleted</code> - Specifies whether the profile-deleted messages will be validated by an external system or not.</p>
<p><code>DuplicateAllowed</code> - Specifies if duplicate functions are permissible.</p>
<p><code>Duplicate</code> - Determines whether a duplicate check is performed for the (display) name.</p>
<p><code>IgnoreCase</code> - Specifies if the duplicate check should be case-insensitive. This is applicable only if <code>DuplicateAllowed</code> is set to false.</p>
<p><code>Regex</code> - Defines the regular expression used to validate the name and displayName.</p>
<p><code>DuplicateEmailAllowed</code> - Indicates whether a duplicate check is performed for email addresses.</p></section><h1 class='nav-section-title-end'>Ended: SagaWorker</h1>
                        <h3 class='nav-section-title' id='section-sync'>
                            Sync <a class='headerlink' href='#section-sync' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="installation-configuration-sync"><h1 id="installation-configuration-sync-sync-configuration">Sync Configuration</h1>
<p>A valid sync configuration can look like this. Please note that you should create a database in ArangoDB and PostgreSQL and grant permissions for the user. This is not done automatically.
The LDAP configuration currently in use is invalid; it's purely an EXAMPLE. Here's a guide on how to properly <a href="#installation-configuration-sync-ldapconfiguration">configure the LDAP Connector</a> for synchronization.</p>
<details class="abstract">
<summary>Sync example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Logging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;EnableLogFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFileMaxHistory&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFilePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;logs&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;json&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LogLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Information&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;Marten&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Host=localhost;Port=5432;Username=myUser;Password=myPassword;Database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DatabaseSchema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserProfile&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;StreamNamePrefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ups&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;SubscriptionName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserProfileServiceStream&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;Messaging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;RabbitMQ&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5672</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sb&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;VirtualHost&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RabbitMQ&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;ProfileStorage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ClusterConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;DocumentCollections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;NumberOfShards&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ReplicationFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;WriteConcern&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;EdgeCollections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;NumberOfShards&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ReplicationFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;WriteConcern&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Endpoints=http://localhost:8529;UserName=myUser;Password=myPassword;database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MinutesBetweenChecks&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;Redis&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;AbortOnConnectFail&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;AllowAdmin&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ConnectRetry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ConnectTimeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EndpointUrls&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;localhost:6379&quot;</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ExpirationTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Password&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;Routing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;DiscardResponsePathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;PathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;SyncConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;SourceConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Systems&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Ldap&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;EntitiesMapping&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;DisplayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;displayname&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mail&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;FirstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;givenName&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;LastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sn&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;UserName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cn&quot;</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nt">&quot;LdapConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;Connection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;AuthenticationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;BasePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dc=ad, dc=example, dc=com&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LDAP://ad.exmpale.com&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Default AD of A365 development environment&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;IgnoreCertificate&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">389</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;ServiceUser&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CN=dev,OU=ExampleOU,OU=ExampleOU2,OU=DEVOU,DC=ad,DC=example,DC=com&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;ServiceUserPassword&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Password&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;UseSsl&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nt">&quot;LdapQueries&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;Filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;(&amp;(|(objectClass=user)(objectClass=inetOrgPerson))(!(objectClass=computer))(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))&quot;</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;SearchBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OU=Users,OU=Accounts,OU=Management&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;ForceDelete&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;False&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;Operations&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Add,Update,Delete&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nt">&quot;Validation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Commands&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;External&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;profile-deleted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;Internal&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;DuplicateEmailAllowed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Tracing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;OtlpEndpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;ServiceName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;userprofile-sync&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>The service is configured to allow access to all necessary third-party components through the localhost endpoints.</p></section><section class="print-page" id="installation-configuration-sync-ldapconfiguration"><h1 id="installation-configuration-sync-ldapconfiguration-configure-ldap-connector">Configure LDAP Connector</h1>
<p>As of now, we offer support for an LDAP Connector capable of synchronizing data from an existing Active Direcotry for example. The configuration for this feature can be found under the <code>LDAP</code> section. We will explain all sections step by step. Below is an example configuration for the Active Directory System.</p>
<details class="abstract">
<summary>LDAP example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Ldap&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;EntitiesMapping&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;DisplayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;displayname&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mail&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;FirstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;givenName&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;LastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sn&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;UserName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cn&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;LdapConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Connection&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;AuthenticationType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;BasePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dc=ad, dc=example, dc=com&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LDAP://ad.exmpale.com&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;Description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Default AD of A365 development environment&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;IgnoreCertificate&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">389</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ServiceUser&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CN=dev,OU=ExampleOU,OU=ExampleOU2,OU=DEVOU,DC=ad,DC=example,DC=com&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ServiceUserPassword&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Password&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;UseSsl&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;LdapQueries&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;(&amp;(|(objectClass=user)(objectClass=inetOrgPerson))(!(objectClass=computer))(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;SearchBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OU=Users,OU=Accounts,OU=Management&quot;</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;ForceDelete&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;False&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Operations&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Add,Update,Delete&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h3 id="installation-configuration-sync-ldapconfiguration-entitiesmapping-section">EntitiesMapping Section</h3>
<p>The entity mapping is utilized to map <a href="https://documentation.sailpoint.com/connectors/active_directory/help/integrating_active_directory/ldap_names.html">LDAP attributes</a> to the user. On the left side, properties of the user model are specified. On the right side, LDAP attributes are utilized. Therefore, the <strong>DisplayName</strong> property will contain values stored under the attribute <strong>displayName</strong> in the LDAP Sytem. It's important to note that the properties of the user model must be written exactly as in the class. Refer to the <a href="https://github.com/bechtleav360/Maverick.UserProfileService/blob/main/src/Maverick.UserProfileService.Models/BasicModels/UserBasic.cs">UserModel</a> for more details.</p>
<h3 id="installation-configuration-sync-ldapconfiguration-ldapconfiguration-section">LdapConfiguration Section</h3>
<p>Under the <strong>LdapConfiguration</strong>, you can specify the LDAP system from which you want to synchronize the data. The <strong>Connection</strong> specifies the credentials for accessing the LDAP system. The <strong>LdapQueries</strong> precisely define which users should be synchronized to the user profile system. You can specify multiple LDAP systems from which you want to synchronize.</p>
<h3 id="installation-configuration-sync-ldapconfiguration-connection-section">Connection Section</h3>
<p>The Connection object encapsulates all the necessary properties required to establish a connection with an existing LDAP system. We utilize the Novell.Directory.Ldap.NETStandard library for this purpose. For further details regarding the connection, please refer to the documentation provided here.</p>
<p><code>AuthenticationType</code> - Is used to specify the type of authentication to be used when logging into an existing LDAP system. "None" is using no authentification. Only a username and a password are required.</p>
<p><code>BasePath</code> - The base bath to the LDPA System.</p>
<p><code>ConnectionString</code> - The connection to the LDAP System.</p>
<p><code>Description</code> - The description of the used system. This property is optional.</p>
<p><code>IgnoreCertificate</code> - If a certificate is to be ignored during synchronization with the LDAP System. The default value is <code>false</code>.</p>
<p><code>Port</code> - The port that is used to create a connection to the LDAP-System. The port used to establish the connection is typically 389, which is the standard port for LDAP. The secured standard port is 636, and it should be used when <code>UseSsL</code> is set to true. <strong>Please note</strong> that these ports are standard settings. When configuring your LDAP system, you may also use <strong>other ports</strong>.</p>
<p><code>ServiceUser</code> - The Service user that is used to connect to the LDAP System.</p>
<p><code>ServiceUserPassword</code> - The password of the <code>ServiceUser</code> for logging into the LDAP system.</p>
<p><code>UseSsl</code> - Indicates whether a secure connection to the LDAP system is being used. If this property is enabled, the port must be set to <strong>the secure port</strong>. The standard secure port is 636, but it can vary based on your LDAP system configuration.</p>
<h3 id="installation-configuration-sync-ldapconfiguration-ldapqueries-section">LdapQueries Section</h3>
<p>LDAP queries are search requests sent to an LDAP directory to retrieve specific information. They allow for searching and retrieving data about users, groups, organizational units, and other directory objects. LDAP queries can include various parameters such as filters defining specific search criteria and attributes specifying which information to return.</p>
<p><code>Filter</code> - LDAP filters are expressions used in LDAP queries to specify specific search criteria. They allow for filtering search results to return only objects that meet certain properties.</p>
<p><code>SearchBase</code> - The "SearchBase" in LDAP systems refers to the base distinguished name (DN) from which LDAP searches are initiated. It serves as the starting point for search operations in the directory tree. The server begins the search from this base DN and traverses the directory tree to locate objects matching the search criteria.</p>
<p>You can specify as many queries as needed, ensuring they match the configuration of your LDAP system.</p>
<p>For more information, it's recommended to explore LDAP and familiarize yourself with the various <a href="https://ldap.com/ldap-filters/">filters</a> that can be utilized.</p>
<h3 id="installation-configuration-sync-ldapconfiguration-source-section">Source Section</h3>
<p>This section solely describes the entities that can be synchronized from the LDAP system and whether the entities can be modified in the UserProfileService. For the LDAP Connector, only user entities can be synchronized from an LDAP system. Here is a brief configuration of the source section:</p>
<details class="abstract">
<summary>LDAP source example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;ForceDelete&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;False&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Operations&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Add,Update,Delete&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>Operations</code> - Defines the operations that can be performed on users. Possible configurations include <code>added</code>, <code>updated</code>, or <code>deleted</code>.</p>
<p><code>ForceDelete</code> - Indicates whether users should be forcefully deleted if they are not present in the LDAP system.</p>
<h3 id="installation-configuration-sync-ldapconfiguration-recommendation">Recommendation</h3>
<p>This was just a brief introduction to configuring the synchronization system using LDAP. We assume familiarity with this protocol. If not, we recommend further reading to gain understanding.</p></section><section class="print-page" id="installation-configuration-sync-validation"><h1 id="installation-configuration-sync-validation-configure-sync-validation">Configure Sync Validation</h1>
<p>Here is a brief section on how the validation can be configured</p>
<details class="abstract">
<summary>Sync validation example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Validation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Commands&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;External&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;profile-deleted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Internal&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;DuplicateEmailAllowed&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>profile-deleted</code> - Specifies whether the profile-deleted messages will be validated by an external system or not.</p>
<p><code>DuplicateEmailAllowed</code> - Indicates whether a duplicate check is performed for email addresses.</p></section><h1 class='nav-section-title-end'>Ended: Sync</h1>
                        <h3 class='nav-section-title' id='section-messaging'>
                            Messaging <a class='headerlink' href='#section-messaging' title='Permanent link'>↵</a>
                        </h3>
                        <section class="print-page" id="installation-configuration-messaging"><h1 id="installation-configuration-messaging-message-configuration">Message Configuration</h1>
<p>The UPS can be configured to use two different queue communication systems for communication between its workers. You can use:</p>
<ul>
<li><a href="#installation-configuration-messaging-rabbitmq">RabbitMq</a></li>
<li><a href="#installation-configuration-messaging-azureservicebus">ServiceBus</a></li>
</ul>
<p>The important key is <code>Type</code>. This key configures the communication system. The JSON to configure the messaging looks similar to these examples:</p>
<details class="abstract">
<summary>Messaging configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Messaging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;MessageType&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="err">...</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MessageType&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>For the <code>Type</code> key, you can use the value <code>RabbitMq</code> or <code>ServiceBus</code>. The keywords are case-insensitive, so it doesn't matter how you write them.</p></section><section class="print-page" id="installation-configuration-messaging-azureservicebus"><h1 id="installation-configuration-messaging-azureservicebus-azure-service-bus">Azure Service Bus</h1>
<p>If you want to use <a href="https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-messaging-overview">AzureServicBus</a> for communication, you need to set <code>ServiceBus</code> as the value for the <code>Type</code> key. This will ensure that internal messaging uses Azure Service Bus.</p>
<p>An example configuration section could look like this:</p>
<details class="abstract">
<summary>Azure Service Bus example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Messaging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ServiceBus&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Endpoint=sb://&lt;NamespaceName&gt;.servicebus.windows.net/;</span>
<span class="s2">      SharedAccessKeyName=&lt;KeyName&gt;;SharedAccessKey=&lt;KeyValue&gt;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ServiceBus&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>Endpoint</code> - The URL of your Service Bus namespace. This always starts with <strong>sb://</strong>, followed by your Service Bus namespace name, and ends with <strong>.servicebus.windows</strong>.net/.</p>
<p><code>SharedAccessKeyName</code> - The name of the shared access policy you are using. This is usually a policy that grants access to the Service Bus namespace or a specific queue/topic.</p>
<p><code>SharedAccessKey</code> - The key associated with the shared access policy. This is a secret value that acts like a password for the connection.</p></section><section class="print-page" id="installation-configuration-messaging-rabbitmq"><h1 id="installation-configuration-messaging-rabbitmq-rabbitmq">RabbitMQ</h1>
<p>If you want to use <a href="https://www.rabbitmq.com/">RabbitMq</a> for communication, you need to set <code>RabbitMQ</code> as the value for the <code>Type</code> key. This will ensure that internal messaging uses RabbitMQ.</p>
<p>An example configuration section could look like this:</p>
<details class="abstract">
<summary>RabbitMQ example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Messaging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;RabbitMQ&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;myPassword&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5672</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;myUser&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;VirtualHost&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RabbitMQ&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p><code>Host</code> - The RabbitMQ server's hostname or IP address.</p>
<p><code>Port</code> - The port number on which RabbitMQ is listening.</p>
<p><code>VirtualHost</code> - The virtual host in RabbitMQ to which you want to connect.</p>
<p><code>User</code> - The username used to authenticate with RabbitMQ.</p>
<p><code>Password</code> - The password associated with the RabbitMQ user.</p></section><h1 class='nav-section-title-end'>Ended: Messaging</h1><section class="print-page" id="installation-configuration-basepath"><h1 id="installation-configuration-basepath-base-path-handling">Base-Path Handling</h1>
<p>Additionally, you can opt-in to automatically handle routing base-paths.<br />
This is useful to make your service available behind a reverse-proxy or similar setup.
To do this, you need to use this method:</p>
<ul>
<li>Full Path: <code>UserProfileService.Hosting.ApplicationBuilderExtensions.UseReverseProxyPathBases</code></li>
<li>As extension: <code>appBuilder.UseReverseProxyPathBases(Configuration)</code></li>
</ul>
<p>This extension will look for these settings, and configure your application accordingly:</p>
<details class="abstract">
<summary>Base-Path example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Routing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;PathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;DiscardResponsePathBase&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>When setting <code>Routing:PathBase</code>, your application will accept requests to all of your usual endpoints (<code>/api/foo</code>), but also those that have the configured Prefix (<code>/service/api/foo</code>).<br />
This ensures compatibility with or without reverse-proxy, and pushes consumers of your API to use endpoints with their respective <code>PathBase</code>.<br />
You can check <code>HttpContext.Request.PathBase</code> to see if the current request was handled with or without base-path.<br />
If <code>Routing:PathBase</code> is set, all redirects will be relative to the configured <code>PathBase</code>, even for those that were handled without it.</p>
<ul>
<li><code>/api/foo</code> redirecting to the <code>api/bar</code>-endpoint will instead be redirected to <code>/service/api/bar</code></li>
<li><code>/service/api/foo</code> redirecting to the <code>api/bar</code>-endpoint will also redirect to <code>/service/api/bar</code></li>
</ul>
<p>When setting <code>Routing:DiscardResponsePathBase</code> your application will behave as if <code>Routing:PathBase</code> was set, but instead of changing all redirects to use the configured prefix, it will be removed from all redirects.</p>
<ul>
<li><code>/api/foo</code> redirecting to the <code>api/bar</code>-endpoint will still be redirected to <code>/api/bar</code></li>
<li><code>/service/api/foo</code> redirecting to the <code>api/bar</code>-endpoint will instead redirect to <code>/api/bar</code></li>
</ul>
<h2 id="installation-configuration-basepath-technical-notes-to-base-path-handling">Technical notes to Base-Path handling</h2>
<p>There are three components to the Base-Path handling, one of which is hidden.
- <code>PathBase</code>
  - Endpoints will also be bound with this as prefix
- <code>ResponsePrefix</code>
  - Ensures outgoing responses use this prefix in their path
- <code>DiscardResponsePathBase</code>
  - Removes this path from the start of all outgoing responses</p>
<p>For simplicity's sake we chose to omit <code>RequestPrefix</code> and always use it together with <code>PathBase</code>, which leaves only Options 0 (no settings), 2 (<code>PathBase</code>), and 4 (<code>DiscardResponsePathBase</code>).</p>
<p>Using these three settings in different configurations results in these Use-Cases:</p>
<h2 id="installation-configuration-basepath-option-0-fallback">Option 0 - Fallback</h2>
<ul>
<li>No option used</li>
<li>Endpoints bound using <code>Base=/</code></li>
<li>Redirects always use <code>PathBase=/</code></li>
</ul>
<p>Without any configuration services will use <strong>Option-0</strong>, they will only be bound and respond to the endpoints defined in the code.<br />
To use this configuration each service needs its own hostname or ip to respond to.</p>
<h2 id="installation-configuration-basepath-option-1-not-supported">Option 1 - Not Supported</h2>
<ul>
<li><code>PathBase=/service</code></li>
<li>Endpoints bound using <code>Base=/</code> and <code>Base=/service</code></li>
<li>Redirects keep the Base they originally arrived with</li>
</ul>
<p>Basically the same as <strong>Option-2</strong>, but doesn't show or encourage use of endpoints with a defined Base.</p>
<h2 id="installation-configuration-basepath-option-2-target-default">Option 2 - Target-Default</h2>
<ul>
<li><code>PathBase=/service</code> + <code>RequestPrefix=/service</code></li>
<li>Endpoints bound using <code>Base=/</code> and <code>Base=/service</code></li>
<li>Redirects will always use <code>Base=/service</code></li>
</ul>
<p>Basically the same as <strong>Options-1</strong>, but pushes consumers to use endpoints with a defined Base.<br />
We chose to implicitly use <strong>Option-2</strong> and hide <strong>Option-1</strong>, to hopefully reduce bugs related to path-mapped services.</p>
<h2 id="installation-configuration-basepath-option-3-not-supported">Option 3 - Not Supported</h2>
<ul>
<li><code>RequestPrefix=/service</code></li>
<li>Endpoints bound using <code>Base=/</code></li>
<li>Redirects will always use <code>Base=/service</code></li>
</ul>
<p>While writing this extension we could find no real use-case for <strong>Option-3</strong>.</p>
<h2 id="installation-configuration-basepath-option-4-supported-just-in-case">Option 4 - Supported just in case</h2>
<ul>
<li><code>DiscardResponsePathBase=/service</code> + (<code>RequestPrefix=""</code> &amp; <code>PathBase=""</code>)</li>
<li>Using <code>DiscardResponsePathBase</code> with any other option did not lead to usable results</li>
<li>Endpoints bound using <code>Base=/</code> and <code>Base=/service</code></li>
<li>Redirects will always use <code>Base=/</code></li>
</ul>
<p>While we don't expect usage of <strong>Option-4</strong>, we can see scenarios where this configuration makes sense, so we added it to this extension.<br />
Using <code>DiscardResponsePathBase</code> with any other setting did not produce usable results, so we chose to treat its use with other settings as an error.</p></section><section class="print-page" id="installation-configuration-databaseconnection"><h1 id="installation-configuration-databaseconnection-database-connections">Database Connections</h1>
<h2 id="installation-configuration-databaseconnection-arangodb">ArangoDb</h2>
<p>The UserProfileService uses a graph database called <a href="https://www.arangodb.com/">ArangoDb</a>.</p>
<p>Example configuration section (as part of the complete appsettings file):</p>
<details class="abstract">
<summary>Arangodb example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;ProfileStorage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ClusterConfiguration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;DocumentCollections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;NumberOfShards&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ReplicationFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;WriteConcern&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;EdgeCollections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;NumberOfShards&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;ReplicationFactor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;WriteConcern&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Endpoints=http://localhost:8529;UserName=myUser;Password=myPassword;database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MinutesBetweenChecks&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>The <code>ConnectionString</code> contains the endpoint of the ArangoDb graph database, the credentials and the database to use.</p>
<p><em>Side note:</em> The specified user must have manage permissions for this database. The service will create collections and therefore needs additional rights.</p>
<p>The <code>ClusterConfiguration</code> contains information about sharding in a cluster environment when collections are created. It will be ignored on <em>single-node</em> installations.</p>
<p><code>MinutesBetweenChecks</code> defines the timespan the database initializer unit will wait until it will ensure all collections has been created. It will do this at the starting of the service as well.<br />
This shall minimize the requests sending to ArangoDb during execution of the application.</p>
<h2 id="installation-configuration-databaseconnection-postgresql">PostgreSQL</h2>
<p>The UserProfileService uses <a href="https://www.postgresql.org/">PostgreSQL</a> as a relational database. It can be configured as follows:</p>
<p>The <code>ConnectionString</code> defines all parameters to establish a database connection (see <a href="https://www.npgsql.org/doc/connection-string-parameters.html">NpgSql docs - connection string parameters</a>)</p>
<p><code>DatabaseSchema</code> defines the name of the schema to be used.</p>
<p>Example:</p>
<details class="abstract">
<summary>PostgreSQL example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Marten&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Host=localhost;Port=5432;Username=myUser;Password=myPassword;Database=UserProfileService&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;DatabaseSchema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;UserProfile&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details></section><section class="print-page" id="installation-configuration-logging"><h1 id="installation-configuration-logging-logging">Logging</h1>
<p>The configuration uses the default .NET Core "Logging" configuration of the MEL stack and extends it in an easy way.<br />
We are using <code>NLog</code> internally to write logs.</p>
<h2 id="installation-configuration-logging-configuration-loglevel">Configuration LogLevel</h2>
<blockquote>
<p><strong>Note:</strong> If no configuration is provided the logframework will only log <code>Information</code> or higher (higher meaning greater loglevel value)</p>
</blockquote>
<table>
<thead>
<tr>
<th>LogLevel</th>
<th>Value</th>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trace</td>
<td>0</td>
<td>LogTrace</td>
<td>Contain the most detailed messages. These messages may contain sensitive app data. These messages are disabled by default and should not be enabled in production.</td>
</tr>
<tr>
<td>Debug</td>
<td>1</td>
<td>LogDebug</td>
<td>For debugging and development. Use with caution in production due to the high volume.</td>
</tr>
<tr>
<td>Information</td>
<td>2</td>
<td>LogInformation</td>
<td>Tracks the general flow of the app. May have long-term value.</td>
</tr>
<tr>
<td>Warning</td>
<td>3</td>
<td>LogWarning</td>
<td>For abnormal or unexpected events. Typically includes errors or conditions that don't cause the app to fail.</td>
</tr>
<tr>
<td>Error</td>
<td>4</td>
<td>LogError</td>
<td>For errors and exceptions that cannot be handled. These messages indicate a failure in the current operation or request, not an app-wide failure.</td>
</tr>
<tr>
<td>Critical</td>
<td>5</td>
<td>LogCritical</td>
<td>For failures that require immediate attention. Examples: data loss scenarios, out of disk space.</td>
</tr>
<tr>
<td>None</td>
<td>6</td>
<td></td>
<td>Specifies that a logging category should not write any messages.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> In the <code>LogLevel</code> sub-section you can configure the category specific log level and the global log level.
The most specific category configuration is used meaning if <code>SomeCategory</code> is set to Error but <code>SomeCategory.SubSomeCategory</code>
is set to trace, than everything in <code>SomeCategory</code> only logs error or higher, but everything staring from <code>SomeCategory.SubSomeCategory</code> will log trace or higher</p>
</blockquote>
<p>To specify the global loglevel use the <code>Default</code> category name</p>
<details class="abstract">
<summary>Logging example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Logging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;LogLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Trace&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;&lt;CategoryName&gt;&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;LogLevel as string&gt;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h5 id="installation-configuration-logging-default-configuration-console-only">Default configuration (console only)</h5>
<details class="abstract">
<summary>Logging example console configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Logging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;LogLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Information&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="installation-configuration-logging-file-logging">File Logging</h2>
<p>To include file logging you need to add the following config-keys inside the "Logging" section</p>
<details class="abstract">
<summary>Logging example file configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Logging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;EnableLogFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="c1">// (Optional) default: false</span>
<span class="w">    </span><span class="nt">&quot;LogFilePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;logs&quot;</span><span class="w"> </span><span class="c1">// (Optional) default: &quot;logs&quot;</span>
<span class="w">    </span><span class="nt">&quot;LogFileMaxHistory&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="c1">// (Optional) default: 3</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h2 id="installation-configuration-logging-log-format-text-or-json">Log format (Text or JSON)</h2>
<p>To change the log format from JSON (default) to Plaintext change the <code>LogFormat</code> key to the value of <code>text</code> or <code>json</code></p>
<details class="abstract">
<summary>Logging example log format configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Logging&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;LogFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details></section><section class="print-page" id="installation-configuration-redis"><h1 id="installation-configuration-redis-redis">Redis</h1>
<p>The UserProfileService-Sync uses Redis as a temporary storage for the synchronized data.</p>
<p>An example configuration section could look like this:</p>
<details class="abstract">
<summary>Redis example configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Redis&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ServiceName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;redis&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;AbortOnConnectFail&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;False&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;AllowAdmin&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;True&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ConnectRetry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ConnectTimeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EndpointUrls&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;localhost:6379&quot;</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;ExpirationTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;User&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>The <code>EndpointUrls</code> define the endpoints for Redis. Please note that <code>EndpointUrls</code> is an array where you can store more than one Redis endpoint. In this section, Redis is only bound to localhost. The port <strong>6379</strong> is the standard port for Redis.</p>
<p>The <code>User</code> and <code>Password</code> are used for authentication to the Redis system.</p>
<p>The other configuration options for redis:</p>
<p><code>ServiceName</code> -  The service name used to resolve a service via the <a href="https://redis.io/docs/management/sentinel/">Sentinel</a>.</p>
<p><code>AbortOnConnectFail</code> - A connection will not be established while no servers are available.</p>
<p><code>AllowAdmin</code> - Enables a range of commands that are considered risky.</p>
<p><code>ConnectRetry</code> - The number of times to repeat connect attempts during initial Connect.</p>
<p><code>ConnectTimeout</code> - Timeout (ms) for connect operations.</p>
<p><code>ExpirationTime</code> - Expiration time after the stored values in redis expires and are deleted (in seconds).</p></section><section class="print-page" id="installation-configuration-tracing"><h1 id="installation-configuration-tracing-tracing">Tracing</h1>
<p>Basic configuration requires you to set at least a <code>ServiceName</code>. The service name will be displayed in the trace graph and used to correlate the logs.
If you also provide an <code>OtlpEndpoint</code> URI the OtlpExporter will be setup to send traces via GRPC in the OTLP format to the provided endpoint.</p>
<p>An example of the trace configuration can resemble this:</p>
<details class="abstract">
<summary>Tracing exmaple configuration</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Tracing&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;OtlpEndpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://localhost:4317&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;ServiceName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;userprofile-service&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details></section><h1 class='nav-section-title-end'>Ended: Configuration</h1>
                        <h2 class='nav-section-title' id='section-get-started'>
                            Get Started <a class='headerlink' href='#section-get-started' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="installation-get%20started-docker"><h1 id="installation-get%20started-docker-docker-files">Docker Files</h1>
<p>We have prepared a set of docker compose files, allowing you to effortlessly set up and explore UserProfileService in isolated containers. The files include all third-party dependencies and are pre-configured to run seamlessly within the container environment.</p>
<p>Please be aware that the examples provided should not be used in a production environment! They are intended to give you an impression of how the UserProfileService works and should only be utilized in a <strong>development environment</strong> for testing purposes.</p>
<p>The examples can be found <a href="https://github.com/bechtleav360/Maverick.UserProfileService/tree/main/examples/">here</a>.</p></section><section class="print-page" id="installation-get%20started-single%20instance"><h1 id="installation-get%20started-single%20instance-single-instance">Single Instance</h1>
<p>If you want to start the user profile service from the codebase and you have met all the <a href="#installation-requirements">requirements</a>, you can launch it from the console. First, clone the code from GitHub:</p>
<p><code>git clone https://github.com/bechtleav360/Maverick.UserProfileService.git</code></p>
<p>Then you can start each components with the command:
<code>dotnet run</code></p>
<p>You need to navigate to the correct folder:</p>
<ul>
<li>For starting UserProfile-API: <code>../Maverick.UserProfileService/src/UserProfileService</code></li>
<li>For startingstarting Saga-Worker: <code>../Maverick.UserProfileServicesrc/src/UserProfileService.Saga.Worker</code></li>
<li>For starting UPS-Sync: <code>../Maverick.UserProfileServicesrc/src/UserProfileService.Sync</code></li>
</ul>
<h2 id="installation-get%20started-single%20instance-starting-the-ups-from-an-ide">Starting the UPS from an IDE</h2>
<p>To start the UPS with an IDE, you can use either <a href="https://visualstudio.microsoft.com/de/downloads/">Visual Studio 2022 Community Edition</a> or <a href="https://www.jetbrains.com/de-de/rider/">Rider</a>. Please note that Rider offers only a 30-day trial period. You can open the solution <code>UserProfileService.sln</code> located in the folder <code>../Maverick.UserProfileService</code>.</p></section><h1 class='nav-section-title-end'>Ended: Get Started</h1><h1 class='nav-section-title-end'>Ended: Installation</h1>
                        <h1 class='nav-section-title' id='section-troubleshooting'>
                            Troubleshooting <a class='headerlink' href='#section-troubleshooting' title='Permanent link'>↵</a>
                        </h1>
                        <section class="print-page" id="troubleshooting-firststeps"><h1 id="troubleshooting-firststeps-first-steps">First Steps</h1>
<h3 id="troubleshooting-firststeps-troubleshooting-steps-for-service-or-saga-worker">Troubleshooting Steps for Service or Saga-Worker</h3>
<p>When encountering issues with a service or Saga-Worker, follow these systematic steps to diagnose and resolve the problem effectively:</p>
<h4 id="troubleshooting-firststeps-check-service-or-saga-worker-status">Check Service or Saga-Worker Status</h4>
<p>Start by verifying if the Service or Saga-Worker is running as expected. If not, proceed with the following steps:</p>
<h4 id="troubleshooting-firststeps-log-and-configuration-examination">Log and Configuration Examination</h4>
<ol>
<li><strong>Check Logs and Configuration:</strong></li>
<li>Review logs for any errors or anomalies that might indicate why the service is not running.</li>
<li>Ensure that the configuration settings are correctly set up and aligned with the service requirements.</li>
</ol>
<h4 id="troubleshooting-firststeps-logging-level-adjustment">Logging Level Adjustment</h4>
<p>For deeper insights into the issue, consider increasing the log level to Debug or Trace:</p>
<ol>
<li><strong>Adjust Log Level:</strong></li>
<li>Increase log verbosity to Debug or Trace to gather more detailed information.</li>
</ol>
<h4 id="troubleshooting-firststeps-credentials-verification">Credentials Verification</h4>
<ol>
<li><strong>Verify Credentials:</strong></li>
<li>Double-check credentials used by third-party components to prevent authentication issues.</li>
<li>Look out for "not authorized - 401" messages in logs as indicators of authentication failures.</li>
</ol>
<h4 id="troubleshooting-firststeps-health-endpoints-analysis">Health-Endpoints Analysis</h4>
<ol>
<li><strong>Check Health-Endpoints:</strong></li>
<li>Utilize health-endpoints to assess the <a href="#troubleshooting-health">overall system health</a>.<ul>
<li>Verify the existence and accessibility of critical components like databases (e.g., ArangDb, Postgres) through state endpoints.</li>
<li>Ensure that the correct credentials are used for accessing these components.</li>
</ul>
</li>
</ol>
<h4 id="troubleshooting-firststeps-log-analysis">Log Analysis</h4>
<ol>
<li><strong>Review Logs for Context:</strong></li>
<li>Analyze logs for additional context, errors, or warnings related to the issue.</li>
</ol>
<h4 id="troubleshooting-firststeps-queue-inspection">Queue Inspection</h4>
<ol>
<li><strong>Inspect Message Queues:</strong></li>
<li>Check for error messages or stalled processes in message queues, especially in asynchronous communication scenarios.</li>
</ol>
<p>By following these steps in a methodical manner, you can efficiently troubleshoot and resolve issues affecting your service or Saga-Worker, minimizing downtime and ensuring smooth operation.</p></section><section class="print-page" id="troubleshooting-health"><h1 id="troubleshooting-health-health-endpoints">Health Endpoints</h1>
<p>Cloud environments, including Kubernetes, rely on health endpoints to monitor and maintain application performance and availability, enabling automated actions and improving system reliability.
The UPS can also run within a cloud-based environment and provide health endpoints. The types of supported health-endpoints are:</p>
<ul>
<li>Liveness<ul>
<li><code>/health/live</code></li>
<li>Is the service started and theoretically functional (config/port binding/DLLs loaded)</li>
</ul>
</li>
<li>Readyness<ul>
<li><code>/health/ready</code></li>
<li>Is the service capable of performing its tasks (processing messages/events/requests)</li>
</ul>
</li>
<li>Status<ul>
<li><code>/health/state</code></li>
<li>Display additional information from the service</li>
</ul>
</li>
</ul>
<p>If the UPS is not running, health endpoints can help identify the issue or serve as the first step in troubleshooting. Below is an example of the /health/state endpoint from the UPS API:</p>
<details class="abstract">
<summary>Health-Endpoints example state</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;sagaWorker&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;healthy&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;degraded&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;unhealthy&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7.4.4.92&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;sync&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;healthy&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;degraded&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;unhealthy&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7.4.4.92&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;arangodb-internal&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3.9.3&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;license&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;community&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;server&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;arango&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;arangoDB&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;updatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-05-08T12:57:42.9260267Z&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;failureStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Unhealthy&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;masstransit-bus&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;endpoints&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;rabbitmq://rabbitmq.dev.env.av360.org/maverick.user-profile.api-submit-command-response&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ready&quot;</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="nt">&quot;rabbitmq://rabbitmq.dev.env.av360.org/maverick.user-profile.api-health-check-message.consumer?temporary=true&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ready&quot;</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="nt">&quot;rabbitmq://rabbitmq.dev.env.av360.org/f7e26e9d21dc_UserProfileServiceCustom_bus_yryyyyfcncbrfp53bdqgsh19rf?temporary=true&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ready (not started)&quot;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;redis-internal&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;redis&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;updatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-05-08T12:57:42.9260362Z&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;failureStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Degraded&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Healthy&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7.4.4.92&quot;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>They display the health status of the utilized third-party components and also show the current version of the service. Additionally, they indicate the health status of the UPS components: the <strong>SagaWorker</strong> and the <strong>Sync</strong>. The Sync also offers a <code>health/state</code> endpoint. You can also, of course, utilize the other health endpoints.</p></section><section class="print-page" id="troubleshooting-known%20issues"><h1 id="troubleshooting-known%20issues-known-issues">Known Issues</h1>
<p>Some known Issue are:</p>
<ul>
<li>Operation progress is pending for an entity.</li>
<li>Entity cannot be deleted.</li>
<li>Inconsistency in the database.</li>
<li>Precompiled files in Marten.</li>
<li>Sync is syncing users twice or more times.</li>
</ul></section><h1 class='nav-section-title-end'>Ended: Troubleshooting</h1>
                        <h1 class='nav-section-title' id='section-for-developer'>
                            For Developer <a class='headerlink' href='#section-for-developer' title='Permanent link'>↵</a>
                        </h1>
                        
                        <h2 class='nav-section-title' id='section-api'>
                            API <a class='headerlink' href='#section-api' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="for%20developer-api-service"><h1 id="for%20developer-api-service-service">Service</h1>
<p>The Service or the API-Service is the interface for you to interact with the UPS. It provides a wide range of CRUD operations to manipulate currently available entities.</p>
<h2 id="for%20developer-api-service-handling-entity-operations">Handling Entity Operations</h2>
<p>The Service utilizes the <strong>Asynchronous Request-Reply Pattern</strong>.The benefit of this pattern is that requests are handled asynchronously. Only operations that manipulate a entity are handled by this pattern.</p>
<p>When an entity is created, deleted, or updated, a <strong>202 (Accepted) HTTP</strong> response code is received, along with a location link in the header. This link allows tracking the progress of the operation. If the entity is not yet ready, a <strong>202 (Accepted) HTTP</strong> status code is returned. Upon completion of the operation, the location link is redirected using a <strong>302 (Redirect) HTTP</strong> code to the corresponding resource. This approach offers a significant advantage: the service can efficiently handle a high volume of requests simultaneously, while GET requests are processed as usual.</p>
<h2 id="for%20developer-api-service-operation-progess">Operation progess</h2>
<p>Here we are creating a group. <strong>When the operation is triggered, the outcome appears as follows:</strong></p>
<details class="abstract">
<summary>Operation progess example output</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;additionalQueryParameter&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="nt">&quot;details&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="nt">&quot;initiator&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="nt">&quot;objectIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="nt">&quot;operation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CreateGroupProfile&quot;</span><span class="p">,</span>
<span class="nt">&quot;correlationId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00-6b1bd2f59cecbaf31bde3734916e75ef-0eea74be7239fe11-01&quot;</span><span class="p">,</span>
<span class="nt">&quot;errorCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="nt">&quot;errorMessage&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="nt">&quot;finished&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0001-01-01T00:00:00Z&quot;</span><span class="p">,</span>
<span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;6978c11f-b670-4a19-a139-994f4f423c25&quot;</span><span class="p">,</span>
<span class="nt">&quot;started&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-04-12T12:21:17.9407143Z&quot;</span><span class="p">,</span>
<span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pending&quot;</span><span class="p">,</span>
<span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OperationTicket&quot;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>The operation has been registered in the service and will be processed shortly.</p>
<p><strong>When the operation has been processed:</strong></p>
<details class="success">
<summary>Operation proccessed successfully example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;memberOf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="nt">&quot;members&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="nt">&quot;customPropertyUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://userprofile.de/api/v2/profiles/6368956b-56b0-4878-8afc-874c2aadf521/customProperties&quot;</span><span class="p">,</span>
<span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-04-12T12:21:20.7407143Z&quot;</span><span class="p">,</span>
<span class="nt">&quot;displayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AdministrationGroup&quot;</span><span class="p">,</span>
<span class="nt">&quot;externalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;6368956b-56b0-4878-8afc-874c2aadf521&quot;</span><span class="p">,</span>
<span class="nt">&quot;imageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://userprofile.de/api/v2/profiles/6368956b-56b0-4878-8afc-874c2aadf521/image&quot;</span><span class="p">,</span>
<span class="nt">&quot;isMarkedForDeletion&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="nt">&quot;isSystem&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Group&quot;</span><span class="p">,</span>
<span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AdministrationGroup&quot;</span><span class="p">,</span>
<span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Api&quot;</span><span class="p">,</span>
<span class="nt">&quot;synchronizedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="nt">&quot;tagUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://userprofile.de/api/v2/groups/6368956b-56b0-4878-8afc-874c2aadf521/tags&quot;</span><span class="p">,</span>
<span class="nt">&quot;updatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-04-12T12:21:20.7407143Z&quot;</span><span class="p">,</span>
<span class="nt">&quot;weight&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>The operation has been processed, and the entity is now stored in the database. The link is now directing to the current state of the entity stored in the database.</p>
<h2 id="for%20developer-api-service-get-operations">GET Operations</h2>
<p>The GET operations are handled synchronously. If you need to request a large amount of data, the results may be paginated. This means that the result will contain a '<strong>next</strong>' link, allowing you to retrieve the next batch or page of items. This approach ensures that you don't need to request a large number of items all at once.</p>
<p><strong>Result Page for groups:</strong></p>
<details class="abstract">
<summary>Result page example output</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1499</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;nextLink&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://userprofile.de/api/v2/groups?Limit=10&amp;Offset=10&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;previousLink&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;createdAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-03-24T13:45:00.4246881Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;displayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0001_Gruppe&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;externalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;a517f195-1975-4e79-8890-4c32db938cb5&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;isConverted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bonnea&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>In this scenario, the '<strong>next</strong>' link will fetch the next 10 groups of items. The batch size can be chosen according to preference.</p>
<h2 id="for%20developer-api-service-dependencies">Dependencies</h2>
<p>The Service relies on the Saga Worker to perform entity creation, updating, or deletion operations. Without the Service, no manipulation operations are possible. It's crucial to avoid this common error by ensuring the availability and proper functioning of the Saga Worker.</p></section><section class="print-page" id="for%20developer-api-datastructure"><h1 id="for%20developer-api-datastructure-datastructure">Datastructure</h1>
<p>The UPS data is currently stored in <a href="http://arangodb.com">ArangoDB</a>, a graph database that supports graph queries. Data is stored as JSON strings, and ArangoDB offers two types of data structures for storage: Collections and EdgeCollections. Collections store JSON documents. Each document can have varying fields and structures. EdgeCollections are a specialized data store in ArangoDB used for storing relationships between documents in a graph. They enable the definition of directed or undirected edges between nodes.</p>
<h2 id="for%20developer-api-datastructure-used-collections-edgecollections">Used Collections / EdgeCollections</h2>
<p>The service utilizes all collections with the suffix <em>Service_</em>. All data accessible via the API is stored in these collections. To comprehend the collections and their models, refer to the Data Model and managed entities documentation. Further details about these collections will be provided in the documentation.</p>
<h3 id="for%20developer-api-datastructure-service_clientsettingsquery">Service_clientSettingsQuery</h3>
<p>The client settings are also represented as key-value pairs. In addition to custom properties, client settings can be inherited. They can only be used for users and groups. Groups are containers that can be assigned to each other, allowing you to create a hierarchy. Let's first take a look at this example.</p>
<p><img alt="ClientSettings" src="../For%20Developer/API/attachments/svg/ClientSettings.svg" /></p>
<p>The example illustrates groups that are assigned to each other, with users being assigned to these groups. Both entities contain client settings, all of which are inherited in this example. The group <code>Bechtle</code> has client settings that define the <code>IDE</code> used by users in the company. Similarly, the group 'SH Bonn' also has client settings with the same key (<code>IDE</code>). Consequently, the client settings from the 'Bechtle' group are overwritten. As a result, the user <code>Andreas Minz</code>, inheriting client settings from the 'SH Bonn' group, will use the Vim editor as their IDE. </p>
<p>In general, client settings are combined when there are multiple instances. Therefore, both the IDE and the OS client settings will be merged. For example, the user 'Max Mustermann' will use Linux as his  OS, as the client settings from the 'AVS' group will overwrite others. However, Max inherits the IDE settings from the 'SH-Bonn' group. On the other hand, the user 'Sandy Musterfrau' will use Windows 11 as her OS because she inherits it from the 'AVS' group. Nonetheless, her IDE setting will be overridden by her specific client settings, so she uses Visual Studio as her IDE.</p>
<p>In summary, inherited client settings are sourced from higher levels and can be overwritten. When multiple client settings exist, they are combined.</p>
<p>The client settings may appear like this:</p>
<details class="example">
<summary>Client settings example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;IsInherited&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;User&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ProfileId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;b2aba1cc-0d86-4056-9358-594a560baae9&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;SettingsKey&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OS&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0001-01-01T00:00:00Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Windows&quot;</span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<ul>
<li><code>IsInherited</code>: Indicates whether the client setting is inherited.</li>
<li><code>Kind</code>: Denotes the type of profile associated with the client setting.</li>
<li><code>ProfileId</code>: Represents the Id of the profile associated with the client setting.</li>
<li><code>SettingsKey</code>: Identifies the key of the client setting.</li>
<li><code>UpdatedAt</code>: Specifies when the client setting was last updated.</li>
<li><code>Value</code>: Represents the value of the client setting.</li>
</ul>
<h3 id="for%20developer-api-datastructure-service_custompropertiesquery">Service_customPropertiesQuery</h3>
<p>The collections store custom properties for specific users, group or an organization. A custom property consists of a key-value pair, which can be used to add additional information to an entity. The data model for this can look like following:</p>
<details class="example">
<summary>Custom property example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Related&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Service_profilesQuery/6ad843e6-b3cd-457f-b205-33a5813c3c53&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FavoriteColor&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Green&quot;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<ul>
<li>
<p><code>Related</code>- The profile the custom property is added to (user, group or organization)</p>
</li>
<li>
<p><code>Key</code> - The key of the custom property</p>
</li>
<li>
<p><code>Value</code> - The value of the custom property</p>
</li>
</ul>
<h3 id="for%20developer-api-datastructure-service_pathtree">Service_pathTree</h3>
<p>The path tree contains every profile that has assignments to another profile. This means that for a single profile, we have all the assignments necessary to retrieve its members.
Nowadays, we are not using the Path-Tree. It is used to compute the Path of an profile. An Example how an item can look like:</p>
<details class="example">
<summary>Service path tree example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;RelatedProfileId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;b5f59454-be26-4035-b1d8-5cfacbc518a4&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ObjectId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;b5f59454-be26-4035-b1d8-5cfacbc518a4&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="p">}</span>
</code></pre></div>
</details>
<ul>
<li>
<p><code>RelatedProfileId</code> - The Id of the profile for which the member will be retrieved.</p>
</li>
<li>
<p><code>ObjectId</code> - The object to which the item is assigned.</p>
</li>
<li>
<p><code>Tags</code> - The list of tags associated with the profile.</p>
</li>
</ul>
<p>If the <code>RelatedProfileId</code> and <code>ObjectId</code> have the same value, it represents the profile itself. If both values differ, it means that the profile with the <code>RelatedProfileId</code> has a member with an ID shown in the <code>ObjectId</code>. Both documents, whether their Ids are the same or different, are connected via an edge, with the connection stored in the <code>Service_pathTreeEdges</code> collection.</p>
<h3 id="for%20developer-api-datastructure-service_pathtreeedges">Service_pathTreeEdges</h3>
<p>The collection stores the edges that connect the pathTree documents. Each edge collection contains a <code>_to</code> and <code>_from</code> attribute that are fixed. The <code>From</code> and <code>To</code> attributes contain the exact IDs of a pathTree. Each document has a <code>_key</code> property that uniquely identifies a document within the collection. The <code>_id</code> is also a property specific to ArangoDB; it completely identifies a document in a database. Typically, it consists of the collection name and the <code>_key</code> property, such as "<strong>Service_pathTree/10de9702-990a-4cec-91b7-91e622a23ba1</strong>". In the body of the edge, we have conditions, also known as ranged conditions, that will be explained here. The _from and _to fields connect two path documents. As an example, we list the two pathTree documents and the edge. The IDs are typically GUIDs, but for simplicity, we chose easy-to-obtain numbers:</p>
<h4 id="for%20developer-api-datastructure-pathtree-documents">PathTree-Documents</h4>
<details class="example">
<summary>Path tree documents example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;RelatedProfileId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ObjectId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;_id:&quot;</span><span class="p">:</span><span class="s2">&quot;Service_pathTree/45&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;45&quot;</span>
<span class="p">}</span>

<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;RelatedProfileId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ObjectId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;456&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;_id:&quot;</span><span class="p">:</span><span class="s2">&quot;Service_pathTree/46&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;_key&quot;</span><span class="p">:</span><span class="s2">&quot;46&quot;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<h4 id="for%20developer-api-datastructure-edge-connection-the-documents">Edge Connection the documents</h4>
<ul>
<li>
<p><code>_from</code> - Service_pathTree/45</p>
</li>
<li>
<p><code>_to</code> - Service_pathTree/46</p>
</li>
</ul>
<details class="example">
<summary>Path tree connection example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Start&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;End&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;RelatedProfileId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>So, the two documents <code>Service_pathTree/45</code> and <code>Service_pathTree/46</code> are now connected via the edge. Through a graph query across these collections, we can determine which profile has assignments. This can be used to retrieve all users who have active assignments to a group or a function.</p>
<h3 id="for%20developer-api-datastructure-service_profilesquery">Service_profilesQuery</h3>
<p>The <code>Service_profiles</code> collection stores profiles along with their relationships to other profiles. Within this collection, users, organizations, and groups are stored. An example user entry might look like this:</p>
<details class="example">
<summary>User profile example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;FunctionalAccessRights&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;MemberOf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;SecurityAssignments&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;Paths&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;Tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;CustomPropertyUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;UserName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;andreas.mustermann&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;FirstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Andreas&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;LastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mustermann&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;andreas.mustermann@gmx.de&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ImageUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;UserStatus&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;6d78353b-5ff6-4314-aae6-50700afa7295&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Andreas Mustermann&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;DisplayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Andreas Hinz&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;User&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;CreatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-01-02T19:15:09.9954893Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-02-29T10:51:12.7416251Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;TagUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;SynchronizedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Ldap&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Domain&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ad.example.org&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ExternalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;S-1-5-21-966539559-2079964620-3194842515-3311&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;IsConverted&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Ldap&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>Most attributes are self-explanatory, such as <code>UserName</code>, <code>FirstName</code>, <code>LastName</code>, <code>Email</code>, <code>Id</code>, <code>Name</code>, <code>DisplayName</code>, <code>CreatedAt</code>, and <code>UpdatedAt</code>.</p>
<ul>
<li>
<p><code>MemberOf</code>: Represents the groups or organizations to which the profile belongs. For example, a user can be a member of a group.</p>
</li>
<li>
<p><code>SecurityAssignments</code>: Refers to the functions or roles assigned to the profile for security purposes.</p>
</li>
<li>
<p><code>Paths</code>: Contains the path to all active assignments associated with the profile.</p>
</li>
<li>
<p><code>Tags</code>: Represents the tags assigned to the profile.</p>
</li>
<li>
<p><code>CustomPropertyUrl</code>: Provides a link where custom properties associated with the profile can be found.</p>
</li>
<li>
<p><code>ImageUrl</code>: Stores a link to where the user's image is stored, although this functionality is currently not implemented.</p>
</li>
<li>
<p><code>UserStatus</code>: Indicates the status for a specific profile.</p>
</li>
<li>
<p><code>Kind</code>: Specifies the type of profile, such as user, group, or organization.</p>
</li>
<li>
<p><code>Source</code>: Defines the source from which the profile was created, such as an LDAP source in this case.</p>
</li>
<li>
<p><code>Domain</code>: Represents the domain of the user, particularly useful when synchronizing users from LDAP.</p>
</li>
<li>
<p><code>ExternalIds</code>: Holds the external IDs from an external system, such as LDAP. The <code>IsConverted</code> parameter is optional and indicates whether the profile has been converted. A profile may have multiple external IDs if stored in multiple sources.</p>
</li>
</ul>
<p>This entities can be retrieved via Endpoints that the user profile service provides.</p>
<h3 id="for%20developer-api-datastructure-service_rolesfunctionsquery">Service_rolesFunctionsQuery</h3>
<p>This collection stores the roles and functions. A function can be looked like this:</p>
<details class="example">
<summary>Service role/function example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;LinkedProfiles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;65525461-aad5-4a79-95df-b64ce54fe978&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Z20 Administration&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Function&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;OrganizationId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;629c6a09-7c5f-40bd-b1aa-a31667c26511&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Organization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="err">...</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;Role&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">...</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;RoleId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;83fdde77-a78c-4b04-80c6-2221991cf909&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;CreatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2021-10-04T09:41:53.0954287Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;UpdatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2021-10-04T09:41:53.0954287Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;SynchronizedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Api&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ExternalIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>A function consists of a role and an organization, although the organization is not shown in the JSON.</p>
<ul>
<li><code>LinkedProfiles</code>: Represents the linked profiles associated with the function.</li>
<li><code>Type</code>: Indicates the type of entity stored in the collection, with possible values being <code>Function</code> or <code>Role</code>.</li>
<li><code>Source</code>: Specifies the source from which the function was created.</li>
</ul>
<h3 id="for%20developer-api-datastructure-service_tagsquery">Service_tagsQuery</h3>
<p>This collections store tags that are associated with an entity. Tags can be look like this:</p>
<details class="example">
<summary>Tag example</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;916f7364-bf20-4086-84bd-34033d3a5011&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Green&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Custom&quot;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<ul>
<li><code>Id</code>: The ID of the tag.</li>
<li><code>Name</code>: The name of the tag.</li>
<li><code>Type</code>: Specifies the type of the tags, which can be:<ul>
<li><code>Security</code>: Used for security-related tags that determine permissions.</li>
<li><code>Custom</code>: Used for custom tags that have no functional impact but are for marking purposes.</li>
<li><code>FunctionalAccessRights</code>: Primarily for internal use and not critical for functionality.</li>
<li><code>Color</code>: Stores color information, typically inheritable and stored as tags.</li>
</ul>
</li>
</ul>
<h3 id="for%20developer-api-datastructure-service_tickets">Service_tickets</h3>
<p>The collection stores the service ticket when an entity is created, updated, or deleted. This will be explained <a href="#for%20developer-api-ticketstore">here</a>.</p></section><section class="print-page" id="for%20developer-api-ticketstore"><h1 id="for%20developer-api-ticketstore-tickestore">Tickestore</h1>
<p>The ticket store manages requests to the UPS API and oversees their progress. It specifically handles create, delete, and update operations. For instance, when an entity is created, a corresponding ticket is generated in the Ticket Store under <code>Service_tickets</code>. Here's an example of how a ticket that has been created might appear:</p>
<details class="abstract">
<summary>Ticket example output</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;additionalQueryParameter&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;details&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;initiator&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;objectIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;operation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CreateGroupProfile&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;correlationId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00-889bac6d8676c2135354f2d66d9e2dc3-8d76f793dc0310f7-01&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;errorCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;errorMessage&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;finished&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0001-01-01T00:00:00Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;960a0bf3-cb3c-4d44-88c7-f8f243e15838&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;started&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-04-25T11:51:38.3868863Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pending&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OperationTicket&quot;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<ul>
<li>
<p><code>additionalQueryParameter</code>: Sometimes needed for special query parameters (for redirecting to specific entities).</p>
</li>
<li>
<p><code>details</code>: Specifies the details of the problem that occurred.</p>
</li>
<li>
<p><code>initiator</code>: Specifies the ID of the user who initiated the operation. Can be <c>null</c> if the initiator is unknown.</p>
</li>
<li>
<p><code>objectIds</code>: The IDs of the objects that will be processed.</p>
</li>
<li>
<p><code>operation</code>: The operation that is currently being processed.</p>
</li>
<li>
<p><code>correlationId</code>: The correlation ID for the request. This ID is needed to trace the operation if an error occurs.</p>
</li>
<li>
<p><code>errorCode</code>: A code indicating the error that occurred. It will be 0 if none occurred.</p>
</li>
<li>
<p><code>errorMessage</code>: A message describing the error that occurred. It will be <c>null</c> if none occurred.</p>
</li>
<li>
<p><code>finished</code>: The timestamp when the ticket was finished.</p>
</li>
<li>
<p><code>id</code>: The ID of the ticket.</p>
</li>
<li>
<p><code>started</code>: The timestamp when the ticket was started.</p>
</li>
<li>
<p><code>status</code>: The status of the current ticket.</p>
</li>
<li>
<p><code>type</code>: The type of the ticket.</p>
</li>
</ul>
<p>When the ticket is completed without any errors, the <code>status</code> property changes to <code>completed</code>, and <code>finished</code> receives the timestamp when the operation was finished.</p>
<h2 id="for%20developer-api-ticketstore-errorhandling">ErrorHandling</h2>
<p>Typically, most operations are processed without errors. However, as with most systems, errors can occur from time to time. When an error occurs, the operation is not processed, and the manipulation with the entity does not take place. The ticket then contains information about the type of error that occurred, allowing you to investigate it further. An error might look like this:</p>
<details class="failure">
<summary>Ticket error handling example output</summary>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ObjectIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;8c63141d-109b-47d0-ab06-f57b9833c481&quot;</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;Operation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CreateCustomPropertiesForProfile&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Details&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Unable to complete the operation&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Detail&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Validation failed.&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Instance&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;Extensions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;StatusCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BadRequest&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;ValidationResults&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Member&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ResourceId&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;ErrorMessage&quot;</span><span class="p">:</span><span class="w"> </span>
<span class="w">            </span><span class="s2">&quot;Profile with id &#39;8c63141d-109b-47d0-ab06-f57b9833c481&#39; and </span>
<span class="s2">            kind &#39;Unknown&#39; does not exists.&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;AdditionalInformation&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;Initiator&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;AdditionalQueryParameter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;(Or,[{\&quot;Key\&quot;,==,[\&quot;eVorlagenFavorites\&quot;],Or}])&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;abfb5d10-3ad6-45a3-9f55-3c52d58dff9f&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;CorrelationId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00-9501e53c1c12b75e777dea15d86359cb-8599a7b91e3d1ad1-00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;OperationTicket&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Failure&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Started&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-08-22T12:06:18.6140738Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Finished&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-08-22T12:06:18.7112435Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ErrorCode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ErrorMessage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Validation failed.&quot;</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>
</details>
<p>In this case, the validation failed because we attempted to add a custom property to a profile with an unknown type.</p></section><section class="print-page" id="for%20developer-api-rangeconditions"><h1 id="for%20developer-api-rangeconditions-range-conditions">Range Conditions</h1>
<p>You can assign entities to each other in the user profile service. Each assignment has a <code>condition</code> that determines when the assignment is valid. A <code>condition</code> has two properties: <code>start</code> and <code>end</code>. Assignments can have multiple conditions. Conditions can be used to create assignments either in the present or in the future. For example, if a user needs a special privilege in two months within a specific group, you can create a condition for that time period. Alternatively, the user might only need the privilege for a certain duration. </p>
<p>The keyword <code>null</code> holds a specific significance for the two properties in a condition. It indicates that the time range is either unlimited or irrelevant. If you set both properties to <code>null</code>, it signifies that the assignment is valid from its inception and has no end date. When you set the start as <code>null</code> and specify a future date, it indicates that the condition is valid from the present until the specified end date. Alternatively, you can set the <code>start</code> to a specific future date and leave the <code>end</code> as <code>null</code>, signifying that the assignment will commence at that future date and remain valid indefinitely.</p>
<p>In the system, it's not possible to create conditions in the past, and they must not overlap temporally, as the validation process prevents this.</p>
<h3 id="for%20developer-api-rangeconditions-examples">Examples</h3>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>The assignment starts immediately and lasts indefinitely.</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2099-05-02T12:55:19.830Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
The assignment starts immediately and continues until May 2099.</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2099-05-02T12:55:19.830Z&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
The assignment begins in May 2099 and is permanent.</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2102-05-02T12:55:19.830Z&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2099-05-02T12:55:19.830Z&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
The assignment begins in May 2099 and ends in May 2102.</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-06-01&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-06-30&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-06-15&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-07-15&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
In this example, the two conditions overlap. The first condition is valid from June 1, 2024, to June 30, 2024, while the second condition is valid from June 15, 2024, to July 15, 2024, overlapping with the first one. The validation will fail.</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-08-01&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-08-31&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-09-01&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-09-30&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-10-01&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;end&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-10-31&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>In this example, the conditions are clearly separated and all lie in the future without overlapping. The first condition is valid from August 1, 2024, to August 31, 2024, the second condition from September 1, 2024, to September 30, 2024, and the third condition from October 1, 2024, to October 31, 2024.</p></section><section class="print-page" id="for%20developer-api-volatiledata"><h1 id="for%20developer-api-volatiledata-volatile-data">Volatile Data</h1>
<p>You can store data in a non-standard manner where it won't be persisted in the event store but will only be persisted in the PostgreSQL database. This type of data is referred to as volatile data, such as controller settings used in user settings. This data is stored only for the user. To store such data, you need a user settings section, a user Id and a JSON object. For example, you could store favorite links from YouTube or the user's preferred topics for Udemy videos. </p>
<h2 id="for%20developer-api-volatiledata-filtering-the-data">Filtering the Data</h2>
<p>If you are looking for specific user settings, you can filter and sort the results accordingly. The results are returned in a paginated format.</p>
<h3 id="for%20developer-api-volatiledata-usage-of-the-filter-query">Usage of the $filter query</h3>
<p>The <strong>$filter</strong> query is used to filter of result-set through restrictions. It can be seen as a where-Clause  in the sense of SQL. The filter can only be applied to properties of the result item. Nested properties are not supported yet. Filter expressions can be combined with an <code>OR</code> or an <code>AND</code>. In the example below we have a simple data set that represents a user that has only five properties. The filter can be applied of all of these properties.</p>
<details class="example">
<summary>Sam Smith example filter user</summary>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Sam, Smith&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;FirstName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Sam&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;LastName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Smith&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;CreatedAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2022-09-11T09:30:11.6796611+02:00&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">235</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>Let's say we want all user that have the same last name. Several users with the same name can be stored in the database. The query would look like:</p>
<p><code>LastName eq 'Smith'</code></p>
<p>The first item in the query is the property "LastName". As second item we have an operator (valid operators see below).The third item is the value with which you want to compare. The value MUST be quoted if it is a type of string or date (in out case all properties except <code>Id</code>). As quotation only single-quotation can be used. Valid quotes are ' and ′. Number must not be quoted.
Valid operator are:</p>
<ul>
<li><strong>eq</strong>: EqualsOperator</li>
<li><strong>ne</strong>: NotEqualsOperator</li>
<li><strong>gt</strong>: GreaterThenOperator</li>
<li><strong>ge</strong>: GreaterEqualsOperator</li>
<li><strong>lt</strong>: LessThenOperator </li>
<li><strong>le</strong>: LessEqualsOperator </li>
<li><strong>ct</strong>: ContainsOperator</li>
</ul>
<p>The operators can be applied nearly on every property. But for string only <code>eq</code>, <code>ne</code> and <code>ct</code> make sense. </p>
<p><strong>Other Examples</strong></p>
<p><code>LastName eq 'Smith' AND FirstName eq 'Sam'</code></p>
<p>The user with the last name Smith and first name Sam should be filtered. <code>Id eq 235</code> The user with the Id 235 should be retrieved.</p>
<p><code>CreatedAt lt '2023-09-11T09:30:11.6796611+02:00' AND Id ne 235</code></p>
<p>Return all user that were created below the data <strong>'2023-09-11T09:30:11.6796611+02:00'</strong> and <strong>Sam, Smith</strong> should
 not be a part of  the result set.</p>
<p><strong>PLEASE NOTICE</strong>:
 The explanation for the <strong>$filter</strong> was in general. Every endpoint has his own <strong>RESULT</strong>. So please look at the Open-Api description which properties are available.</p>
<h3 id="for%20developer-api-volatiledata-usage-of-the-oderby-clause">Usage of the $oderBy clause</h3>
<p>The <strong>$orderBy</strong> filter lets your order the result set by one or more properties. The properties must be again in the result set. As our result set we will take again our simple example with the user. To order the user by the first name we can using the query:</p>
<p><code>FirstName</code></p>
<p>This will order the user by its first name in an <strong>ascending</strong> order. Please notice that the default-value for the sorting order is <strong>ascending</strong>. If you want to order the result set in a descending order you can use the query: </p>
<p><code>FirstName desc</code></p>
<p>If you forget the default sorting value you can still use the abbreviation asc in the query:</p>
<p><code>FirstName asc</code></p>
<p>It is also possible to sort by two properties. Again we using our simple user model to sort the results by first name in a ascending order and created at in descending order. Notice when using more than two properties you have to separate them with a comma <code>,</code>.</p>
<p><code>FirstName, CreatedAt desc</code></p>
<p>The <strong>$filter</strong> query and the <strong>$orderby</strong> query can be combined.</p></section><h1 class='nav-section-title-end'>Ended: API</h1><h1 class='nav-section-title-end'>Ended: For Developer</h1></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "/", "features": ["content.code.copy", "content.code.select"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>